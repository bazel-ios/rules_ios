load("//rules:app.bzl", "ios_application")
load("//rules:test.bzl", "ios_unit_test")

ios_application(
    name = "App",
    srcs = ["App/main.swift"],
    bundle_id = "com.example.app",

    # FIXME: we still need this here because of infoplist merging
    frameworks = [
        "//tests/ios/frameworks/dynamic/a",
        "//tests/ios/frameworks/dynamic/b",
    ],
    minimum_os_version = "10.0",
    visibility = ["//visibility:public"],

    # Internally the lib has a dep on a, so we need to pass the dep. Would be
    # to pass that through the framework - it drops our providers though
    deps = [
        "//tests/ios/frameworks/dynamic/a",
        "//tests/ios/frameworks/dynamic/b",
    ],
)

ios_unit_test(
    name = "TestAppWithDylibs",
    srcs = ["empty_tests.m"],
    minimum_os_version = "10.0",
    test_host = ":App",
)
